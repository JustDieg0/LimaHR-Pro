<div class="max-w-7xl mx-auto p-4 sm:p-6 lg:p-8">
  <div class="bg-white rounded-lg shadow-lg overflow-hidden">
    <!-- Header -->
    <div
      class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 p-6 bg-linear-to-r from-purple-600 to-indigo-600">
      <h2 class="text-2xl font-bold text-white m-0">Departamentos</h2>
      <p-button label="Nuevo Departamento" icon="pi pi-plus" (onClick)="onCreate()" severity="success"
        class="w-full sm:w-auto">
      </p-button>
    </div>

    <!-- Table Container -->
    <div class="p-6">
      <p-table [value]="departamentos()" [loading]="loading()" [(selection)]="selectedDepartamentos" dataKey="id"
        [paginator]="true" [rows]="10" [rowsPerPageOptions]="[5, 10, 20]" [showCurrentPageReport]="true"
        currentPageReportTemplate="Mostrando {first} a {last} de {totalRecords} departamentos"
        class="shadow-sm rounded-md overflow-hidden">

        <ng-template pTemplate="header">
          <tr class="bg-gray-50">
            <th class="w-12 px-4 py-3">
              <p-tableHeaderCheckbox></p-tableHeaderCheckbox>
            </th>
            <th pSortableColumn="id" class="w-20 px-4 py-3 text-left font-semibold text-gray-700">
              ID <p-sortIcon field="id"></p-sortIcon>
            </th>
            <th pSortableColumn="nombre" class="px-4 py-3 text-left font-semibold text-gray-700">
              Nombre <p-sortIcon field="nombre"></p-sortIcon>
            </th>
            <th class="px-4 py-3 text-left font-semibold text-gray-700">Jefe</th>
            <th class="px-4 py-3 text-left font-semibold text-gray-700">Fecha Creaci√≥n</th>
            <th class="w-36 px-4 py-3 text-center font-semibold text-gray-700">Acciones</th>
          </tr>
        </ng-template>

        <ng-template pTemplate="body" let-depto>
          <tr class="border-b border-gray-200 hover:bg-gray-50 transition-colors">
            <td class="px-4 py-3">
              <p-tableCheckbox [value]="depto"></p-tableCheckbox>
            </td>
            <td class="px-4 py-3 text-gray-600">{{ depto.id }}</td>
            <td class="px-4 py-3">
              <span class="font-semibold text-gray-900">{{ depto.nombre }}</span>
            </td>
            <td class="px-4 py-3">
              @if (depto.jefe) {
              <span class="text-gray-700">{{ depto.jefe }}</span>
              } @else {
              <span class="text-gray-400 italic text-sm">Sin jefe asignado</span>
              }
            </td>
            <td class="px-4 py-3">
              <span class="font-semibold text-gray-900">{{ depto.created_at }}</span>
            </td>
            <td class="px-4 py-3">
              <div class="flex justify-center gap-2">
                <p-button icon="pi pi-pencil" severity="info" size="small" [rounded]="true" [text]="true"
                  (onClick)="onEdit(depto)" pTooltip="Editar" tooltipPosition="top">
                </p-button>
                <p-button icon="pi pi-trash" severity="danger" size="small" [rounded]="true" [text]="true"
                  (onClick)="onDelete(depto)" pTooltip="Eliminar" tooltipPosition="top">
                </p-button>
              </div>
            </td>
          </tr>
        </ng-template>

        <ng-template pTemplate="emptymessage">
          <tr>
            <td colspan="5" class="px-4 py-12">
              <div class="flex flex-col items-center justify-center text-gray-400">
                <i class="pi pi-inbox text-6xl mb-4"></i>
                <p class="text-lg font-medium text-gray-500">No hay departamentos registrados</p>
                <p class="text-sm text-gray-400 mt-1">Crea tu primer departamento haciendo clic en "Nuevo Departamento"
                </p>
              </div>
            </td>
          </tr>
        </ng-template>
      </p-table>
    </div>
  </div>
  <!-- Dialog Crear/Editar Departamento -->
<p-dialog 
    [(visible)]="displayDialog"
    [modal]="true"
    styleClass="w-full md:w-96">
    
    <ng-template pTemplate="header">
      <div class="flex items-center gap-2">
        <i class="pi pi-building text-purple-600 text-xl"></i>
        <h3 class="text-xl font-bold text-gray-800 m-0">
          {{ isEditMode() ? 'Editar' : 'Nuevo' }} Departamento
        </h3>
      </div>
    </ng-template>

    <app-departamento-form
      [departamento]="selectedDepartamento"
      [loading]="saving()"
      (formSubmit)="handleFormSubmit($event)"
      (formCancel)="closeDialog()">
    </app-departamento-form>
  </p-dialog>

  <p-confirmDialog></p-confirmDialog>
  <p-toast></p-toast>
</div>